import shutil
from pathlib import Path

import regex as re
from tqdm import tqdm

NON_END = r"[^\n…。？！]*"

fixes: dict[str, list[tuple[str, str]]] = {
    "*": [
        ("╳", "×"),
        ("冑", "胄"),
        ("飚", "飙"),
        ("跩", "得意"),
        ("又再", "再"),
        ("仅只", "仅"),
        ("嘴喙", "喙"),
        ("诸于", "之于"),
        ("塑胶", "塑料"),
        ("参杂", "掺杂"),
        ("采出", "探出"),
        ("荧幕", "屏幕"),
        ("彷佛", "仿佛"),
        ("败战", "战败"),
        ("卯足", "铆足"),
        ("通讯", "通信"),
        ("做乎", "似乎"),
        ("座台", "基座"),
        ("随道", "隧道"),
        ("招唤", "召唤"),
        ("叫作", "叫做"),
        ("双亲", "父母"),
        ("妈啦", "妈呀"),
        ("发讯", "发信"),
        ("嘻嬉", "嘻嘻"),
        ("蜂涌", "蜂拥"),
        ("拷贝", "复制"),
        ("结冻", "冻结"),
        ("其它", "其他"),
        ("爆风", "气浪"),
        ("一起同", "同"),
        ("几乎快", "快"),
        ("擅长于", "擅长"),
        ("再重新", "重新"),
        ("冷气机", "空调"),
        ("首先先", "首先"),
        ("程序码", "代码"),
        ("排档杆", "挡把"),
        ("一、两", "一两"),
        ("安心感", "安全感"),
        ("抛弃式", "一次性"),
        ("厢型车", "面包车"),
        ("新记录", "新纪录"),
        ("贩卖机", "售货机"),
        ("决定于", "取决于"),
        ("恨恨地", "愤愤地"),
        ("四角锥", "四棱锥"),
        ("打手机", "打电话"),
        ("连想到", "联想到"),
        ("反应在", "反映在"),
        ("交互看", "交替看"),
        ("颈链形", "项圈式"),
        ("时间带", "时间段"),
        ("通信录", "通讯录"),
        ("服务生", "服务员"),
        ("记录片", "纪录片"),
        ("众光灯", "聚光灯"),
        ("罗曼蒂克", "浪漫"),
        ("移动电话", "手机"),
        ("几乎已经", "几乎"),
        ("停止不动", "停止"),
        ("生产制造", "生产"),
        ("突然倏地", "倏地"),
        ("完全痊愈", "痊愈"),
        ("射程距离", "射程"),
        ("提出质疑", "质疑"),
        ("心里非常", "非常"),
        ("瓦砾碎片", "瓦砾"),
        ("为了以防", "以防"),
        ("仿佛像是?", "仿佛"),
        ("尝试想要?", "尝试"),
        ("不自主", "不由自主"),
        ("病毒码", "病毒代码"),
        ("自称[是叫]", "自称"),
        ("自称风", "自称「风」"),
        ("中的其中", "的其中"),
        ("为了不想", "为了不"),
        ("冲击力道", "冲击力"),
        ("学校公交车", "校车"),
        ("在心中想道", "心想"),
        ("脱逃(?!走)", "逃脱"),
        ("视窗(?!口)", "窗口"),
        ("除错(?!误)", "调试"),
        ("荷包(?!蛋)", "钱包"),
        ("远距(?!离)", "远程"),
        ("这(?=其[中间])", ""),
        ("在上课中", "在上课时"),
        ("原本上条", "上条原本"),
        ("严格的说", "严格地说"),
        ("尖峰时刻", "高峰时刻"),
        ("莫名所以", "莫名其妙"),
        ("无法置信", "难以置信"),
        ("密不通风", "密不透风"),
        ("度过难关", "渡过难关"),
        ("三千〇一", "三千零一"),
        ("液晶画面", "液晶屏幕"),
        ("不忍卒睹", "不忍直视"),
        ("归根究底", "归根结底"),
        ("死亡关头", "生死关头"),
        ("行动装置", "移动设备"),
        ("电动游戏", "电子游戏"),
        ("甘冒危险", "甘愿冒险"),
        ("不只这些", "不止这些"),
        ("锐不可挡", "锐不可当"),
        ("(?<!函)授与", "授予"),
        ("携带[型式]", "便携式"),
        ("魔[法导]书", "魔道书"),
        ("(?<=[一千])册", "本"),
        ("绞尽(?!脑汁)", "用尽"),
        ("做便当来", "做便当带来"),
        ("响起同时", "响起的同时"),
        ("(?<!不能)自已", "自己"),
        ("防范于?未然", "防患未然"),
        ("奇异笔|马克笔", "记号笔"),
        ("架人造卫星", "颗人造卫星"),
        ("由下往上看", "从下往上看"),
        ("梵蒂冈市国", "梵蒂冈城国"),
        ("不知如何是好", "不知所措"),
        ("(?<!枫)红萝卜", "胡萝卜"),
        ("夏季用薄毛衣", "夏季薄毛衣"),
        ("四轮传动的?汽?车", "四驱车"),
        ("(?<=[圆球角筒人方碟])型", "形"),
        ("四[边角方]形", "方形"),
        ("(?<=[五六多])角形", "边形"),
        (r"(?<=\p{Han}), ?", "，"),
        (r"(?<=…)\.+", ""),
        (r"(?<![…e])…(?!…)", "……"),
        ("只手指(?![向了])", "根手指"),
        ("(?<=[除并]非)是(?!否)", ""),
        ("正因如此，所以", "正因如此，"),
        ("(?<!这幅巨)大画面", "大屏幕"),
        ("(完全|最后|最终)放学", "清校"),
        ("清校时刻", "清校时间"),
        ("(?<!忽)略(?=.一[点些])", ""),
        ("粘着(?=我|上条|少年)", "黏着"),
        ("(?<![不普])及到(?!什么程度)", "及"),
        (r"出现(?=[^\n…。？！，]*表情)", "露出"),
        ("(?<=试[图着])想要?(?![想象了一])", ""),
        ("(?<=GPS|电视|上网|灭火|应有|驾驶)机能", "功能"),
        ("排.第(.)名?(?!的白|个的|二位|方人|的，)", r"排名第\1"),
        (r"(?<=[\d零一二三四五六七八九十百千万亿兆])圆(?![顶周])", "元"),
        (
            "(?<=理由(，|却不|应该|并不|自然|，多半|，想来只|无他，正|会不会就|，有一种说法|很多，但大半|也很离谱：并不|啊，到头来，该不会)?是)因为",
            "",
        ),
        ("禁书目录X系列</p>", "<ruby>禁书目录X系列<rt>INDEX X</rt></ruby></p>"),
        ("本书内容由知一一", "本书内容由<b>知一一</b>"),
        ("经以下版本进行整合或修改", "基于以下版本整合并修改"),
        ("(?<=使用(Reasily|图书))观看", "阅读"),
        (rf"(?<![因「])为什么(?={NON_END}的理由)", ""),
        (rf"(?<=由于(人体的|要连接|集合了|这层关|内部人){NON_END})使得", ""),
        (rf"由于(?!沙龙包|某个她)(?={NON_END}使得)", ""),
        (rf"(?<=(因为|由于){NON_END}，)因[此而]", "所以"),
        (rf"由于(?={NON_END}所以)", "因为"),
        (rf"(?<=(看来|来看，){NON_END}|来看(自己)?)似乎", ""),
        (
            rf"(?<=(因|由于){NON_END})(?<!特别|机构|良好|丧命|是这样|冲击波|立场上|「暗部」)(之故|所致|的关系|的缘故)",
            "",
        ),
    ],
    "[S0_00]读前必看": [
        ("所带来与改变的", "带来的改变"),
        ("以台版为本体", "以台版为基础"),
        ("优化了并<strong>统一</strong>了", "<strong>统一</strong>并优化了"),
        ("以本人一己之力", "以一己之力"),
        ("没必要感觉", "感觉没必要"),
        ("部分模糊，部分没有翻译", "部分图片模糊，部分文字没有翻译"),
        ("部分模糊，繁体字看着累", "部分图片模糊，繁体字阅读困难"),
        ("原图重新修嵌，美观而且清晰", "原图重新修复嵌字，美观且清晰"),
        ("部分用词不符合大陆人习惯", "部分用词不符合大陆习惯"),
        ("大部分跟随维基或汉化组的最新标准", "大部分遵循维基或汉化组的最新标准"),
        ("持续更新，且有问题可以实时反馈", "持续更新，且可以实时反馈问题"),
        ("自己是最新版本，使用的是", "使用的是最新版本的"),
        (
            "自己主观上觉得有问题的，希望能自己结合日语原版、英翻，来",
            "如果觉得有问题，希望能结合日语原版和英译，",
        ),
    ],
    "[S1_01]某魔法的禁书目录 01X": [
        ("─", "—"),
        ("无以言喻", "难以言喻"),
        ("毫无抵御能力", "毫无抵御之力"),
        ("梳理台", "洗漱台"),
        ("长度到达脚踝", "长度到脚踝"),
        ("升了上来", "抬了起来"),
        ("毫无理由的不相信", "毫无理由地不相信"),
        ("杜林圣骸布", "都灵圣骸布"),
        ("前十名内的", "前十名的"),
        ("皱了眉头", "皱起了眉头"),
        ("手机电话号码", "手机号码"),
        ("重启机按钮", "重启按钮"),
        ("张不开眼睛", "睁不开眼睛"),
        ("只为了想救上条", "只因为想救上条"),
        ("估计大概", "估计"),
    ],
    "[S1_02]某魔法的禁书目录 02X": [
        ("村人", "村民"),
        ("繁华地带完全没有人", "繁华地带，竟然完全没有人"),
        ("往上条袭来", "袭往上条"),
        ("反过来说，每次", "那么每次"),
        ("首先轻叹", "轻叹"),
        ("插在颈上", "插在脖子上"),
        ("无照名医", "无证名医"),
        ("从前原本", "原本"),
    ],
    "[S1_03]某魔法的禁书目录 03X": [
        ("参了各种营养剂", "掺了各种营养剂"),
        ("改良于海湾战争中", "在海湾战争中改良"),
        ("这把狙击枪由于", "因为这把狙击枪"),
        ("子弹弹壳", "子弹壳"),
        ("连发机能", "连发功能"),
        ("中性子", "中子"),
        ("不可思议怪谈", "不可思议"),
        ("350×19＝6.65", "0.35×19＝6.65"),
        ("钢铁铁轨", "钢铁轨道"),
        ("几乎差点", "差点"),
        ("尝试要", "尝试"),
        ("钢骨铁轨", "钢轨"),
    ],
    "[S1_04]某魔法的禁书目录 04X": [
        ("求偿", "索赔"),
        ("张了张", "看了看"),
        ("不知为何土御门", "土御门不知为何"),
        ("绝不能遭到玷污", "绝不能玷污"),
        ("确实的位置", "确切的位置"),
        ("子弹却刺入", "子弹却射入"),
    ],
    "[S1_05]某魔法的禁书目录 05X": [
        ("塑料瓶饮料", "塑料瓶装饮料"),
        ("冷气的室外机", "空调的室外机"),
        ("有及肩的茶色头发及不服输的表情", "有着及肩的茶色头发和不服输的表情"),
        ("可让其他医生", "其他医生可"),
        ("光碟片", "光盘"),
        ("刑求", "刑讯"),
        ("跄跄踉踉", "踉踉跄跄"),
        ("项圈带", "项圈"),
        ("索讨", "索要"),
        ("力力", "力"),
        ("采排外政策", "采取排外政策"),
        ("身染宿疾", "身患宿疾"),
        ("也不参加文化祭", "也不必参加文化祭"),
        ("粗鲁地突然往前狂冲", "突然粗鲁地往前狂冲"),
        ("流用品", "淘汰品"),
        ("影像电话", "视频电话"),
        ("断乳餐", "辅食"),
        ("小小电脑", "小小的电脑"),
        ("操纵把手", "操纵杆"),
        ("流畅地说出", "流利地说出"),
        ("一派悠哉的立场", "一副悠哉的样子"),
        ("将激烈的感情展现在扭曲的脸庞上", "将强烈的情感展现在扭曲的面容上"),
        ("电脑计算室", "计算机房"),
        ("达成这项开发", "完成这项开发"),
        ("交集点", "交点"),
    ],
    "[S1_06]某魔法的禁书目录 06X": [
        ("开学式", "开学典礼"),
        ("有及肩的茶色头发", "有着及肩的茶色头发"),
        ("像男又像女", "像男人又像女人"),
        ("见外感", "疏远感"),
        ("建筑物该有的机能", "建筑物该有的功能"),
        ("还要广范围", "范围还要广"),
        ("居民的八成都是学生", "学生占了居民中的八成"),
        ("枪声弹幕", "枪林弹雨"),
        ("画过脸颊", "划过脸颊"),
        ("仿佛像个", "仿佛一个"),
    ],
    "[S1_07]某魔法的禁书目录 07X": [
        ("数字总合", "数字总和"),
        (
            "所记述的，据说可以召唤天使的惊世魔道书《法之书》，",
            "所著的《法之书》据说可以召唤天使，这本惊世魔道书",
        ),
        ("湿气上升", "湿度增加"),
        ("创造出惊人的温度", "导致惊人的高温"),
        ("人工建构成的海岸边", "人工建造的海岸边"),
        ("迅雷不及掩耳般地", "迅雷不及掩耳地"),
        ("以逸代劳", "以逸待劳"),
        ("脑袋昏昏沉沉的上条", "上条脑袋昏昏沉沉的，"),
        ("全部明白", "完全明白"),
        ("趁胜追击", "乘胜追击"),
        ("发腊", "发蜡"),
        ("负责掌管", "掌管"),
        ("数此", "数次"),
        ("非旦", "非但"),
        ("形状是方方正正的四角形", "形状是方形"),
    ],
    "[S1_08]某魔法的禁书目录 08X": [
        ("头发在头后", "头发在脑后"),
        ("拖着身体回到宿舍后头的白井", "白井拖着身体回到宿舍后头"),
        ("无关普通民众", "无关的普通民众"),
        ("省悟", "醒悟"),
        ("无线电通话机", "无线电对讲机"),
    ],
    "[S1_09]某魔法的禁书目录 09X": [
        ("窗户全部的窗帘", "所有的窗帘"),
        ("道路在陆海空所有区域里，", "在陆海空所有区域里，道路"),
        ("言归正传到我刚刚说的麻烦", "言归正传，回到我刚刚说的麻烦"),
        ("高反动素材", "高弹材料"),
        ("一听到这句话的茵蒂克丝", "茵蒂克丝一听到这句话"),
        ("野外摄影棚", "户外摄影棚"),
        ("高级名牌的味", "高级名牌的韵味"),
        ("型式", "形式"),
        ("接在手机下方的接触器", "连接在手机底部的接口"),
    ],
    "[S1_10]某魔法的禁书目录 10X": [
        ("不知何时接近朝耳边大喊", "不知何时接近，朝耳边大喊"),
        ("因为同样的某些原因", "因为同样的原因"),
        ("打算想", "打算"),
        ("机能应该只是会", "应该只是会"),
        ("一道薄膜", "一层薄膜"),
        ("脉膊", "脉搏"),
        (
            "大热天的日照稍微减弱的下午三点三十分",
            "下午三点三十分，大热天的日照稍微减弱",
        ),
        ("往左右自动打开", "自动往左右打开"),
        ("正面紧追不放", "紧追不放"),
        ("在她在表现出惊讶之前", "在她表现出惊讶之前"),
        ("回应以文字直接", "回应以文字形式直接"),
        ("渗甘美的涌泉", "涌出甘美的泉水"),
        ("没有照明的这间房间", "这间没有照明的房间"),
        ("慎重地仔细", "慎重地"),
        ("这个嘛，就在土御门", "『这个嘛』，就在土御门"),
        ("必须需要", "需要"),
        ("邮箱网址", "邮箱地址"),
        ("这项道具", "这件道具"),
        ("专门外的领域", "专长外的领域"),
        ("全部用尽", "用尽"),
        ("小萌老师差点跌倒", "小萌老师跌倒"),
    ],
    "[S1_11]某魔法的禁书目录 11X": [
        ("装有料理食器", "装有料理的食器"),
        ("放有撕碎蟹肉冷汤", "放有撕碎蟹肉的冷汤"),
        ("。再将这些东西搬进停在公寓外", "，再将这些东西搬进停在公寓外的"),
        ("皮箱打开时里面", "皮箱打开时，里面"),
        ("看到突然脸红转开视线的上条", "看到上条突然脸红转开视线"),
        ("固定海水自由", "固定海水，自由"),
        ("铭谢惠顾", "「谢谢惠顾」"),
        ("二奖", "二等奖"),
        ("倒在地板的", "倒在地板上的"),
        ("突然猛然", "猛然"),
        ("完全平面", "光滑平面"),
        ("底面正方形的四角锥", "正四棱锥"),
        ("因为『亚得里亚海女王』的原因", "因为『亚得里亚海女王』"),
        ("一道木桥", "一座木桥"),
    ],
    "[S1_12]某魔法的禁书目录 12X": [
        ("退了一下", "退了一步"),
        ("被害当事人", "受害者"),
        ("说这话走近", "说着话走近"),
        ("他如果在这里", "如果在这里"),
        ("匐倒", "趴倒"),
        ("洗衣精", "洗衣液"),
        ("生物样品", "生物样本"),
        ("击溃所有死角", "消除所有死角"),
        ("为了不让我们发生状况遇袭", "为了防止我们遇袭"),
        ("开动吃饭", "开始吃饭"),
        ("借此整备出", "借此构建出"),
        ("话一脱口的瞬间", "话刚出口的瞬间"),
        ("住在学园都市大部分的学生都会使用宿舍", "学园都市的大部分学生都会住在宿舍"),
        ("在用汤勺在", "用汤勺在"),
        ("相当正常红色修道服", "相当正常的红色修道服"),
        ("电压的单位恐怕到达上亿", "电压恐怕达到了上亿伏特"),
        ("一世纪单位", "一百年"),
        ("两百CC", "两百毫升"),
        ("百万分之一米", "微米"),
        ("风速达到一百", "风速达到每秒一百"),
        ("逃脱大人们的束缚", "摆脱大人们的束缚"),
        ("反抗另寻出处", "反抗并另寻出路"),
        ("的前三十分钟就在这里", "的半小时前就已经在这里了"),
        ("不管耳边有闹钟响起", "无论是耳边有闹钟响起"),
        ("除去这十五分钟", "除了十五分钟这个限制"),
        ("契约金额相当高", "收费高昂"),
        ("超市或超市", "超市"),
        ("所以从远处来到", "从远处来到"),
        ("她的容许量", "她的食量"),
        ("地板耐震补强器", "地板的耐震补强器"),
        ("全部一概", "一概"),
        ("一手拿着书喝茶", "一手拿书一手喝茶"),
        ("钻爱牛角尖", "爱钻牛角尖"),
        ("最大深部", "最深处"),
        ("不只你一个人", "不止你一个人"),
        ("偷偷摸摸地窃窃私语", "窃窃私语"),
        ("课税", "征税"),
        ("住居", "住处"),
        ("设置型天线基站", "固定型天线基站"),
        ("不用那么制式", "不用那么正式"),
        ("所费不菲", "花费不菲"),
        ("多角化", "多角度"),
        ("嘻皮笑脸", "嬉皮笑脸"),
        ("亚铅", "镀锌"),
        ("具防水性", "具有防水性"),
        ("普通反应", "正常反应"),
        ("拔腿起跑", "拔腿就跑"),
        ("基本最低限度", "基本需求"),
        ("这样的运动", "这样的活动"),
        ("粘在身边", "黏在身边"),
        ("食用期限是", "保质期到"),
    ],
    "[S1_13]某魔法的禁书目录 13X": [
        ("从其他剩下的", "从剩下的其他"),
        ("毫发无伤的救出", "毫发无伤地救出"),
        ("跑出外面道路", "跑出到外面的道路"),
        ("箱型车", "厢型车"),
        ("四方十米", "十米见方"),
        ("横竖坐视不管", "横竖"),
        ("连尖叫还来不及发", "还没来得及尖叫"),
        ("撼动柏油路的轰声炸裂开来", "柏油路炸裂开来"),
        ("开始呻吟毫无抵抗地倒下", "毫无抵抗地倒下，开始呻吟"),
        ("这样的大移动", "这样的大规模移动"),
        ("木材地板", "木地板"),
        ("掉落地板", "掉落在地板上"),
        ("对方可说", "可以说对方"),
        ("砍倒空气", "砍向空气"),
        ("摇摇晃晃不稳", "摇摇晃晃"),
        ("受到的危险", "面临的危险"),
        ("作战只要一开始顺利", "只要作战一开始顺利"),
        ("害怕「自相残杀（或是怕遭到自相残杀）」", "害怕自相残杀"),
        ("「风」的攻击", "风的攻击"),
        ("微笑地继续说道", "微笑着继续说道"),
        ("防碍", "妨碍"),
        ("世界点心", "世界各地的点心"),
        ("通信机械", "通信设备"),
        ("这道铁桥", "这座铁桥"),
        ("以目前的状况下", "在目前的状况下"),
        ("对身体内部蓄积", "在身体内部蓄积"),
        ("转移对方注意同时", "转移对方注意力的同时"),
        ("至少在收拾事态为止", "至少在事态平息之前"),
        ("走山", "滑坡"),
        (
            "但这不仅是基于反动作用，由于过度依靠防御用术式，身体受到外来的冲击而破裂。",
            "但这并非仅因反噬。显然是防御术式被击破，外部冲击撕裂了他的身体。",
        ),
        ("认视", "认识"),
        ("上条的话声", "上条的声音"),
        ("毛端", "毛绒"),
        ("画着强调眼角的浓妆", "化着强调眼角的浓妆"),
    ],
    "[S1_14]某魔法的禁书目录 SS1X": [
        ("风速五十米", "秒速五十米"),
        ("犯罪集团却不只是她", "犯罪者却不只有她"),
        ("要想要帅", "要想耍帅"),
        ("以抽动鞭子般", "像抽动鞭子般"),
        ("微暗的暗巷", "微暗的巷子"),
        ("所有不幸元凶的幕后黑手", "所有不幸的元凶"),
        ("尘埃与灰尘", "尘埃"),
        ("空无一物虚空", "虚空"),
        ("判别出尸体", "辨认出尸体"),
        ("食用期限", "保质期"),
        ("槽了", "糟了"),
        ("武装枪械", "武装着枪械"),
    ],
    "[S1_15]某魔法的禁书目录 14X": [
        ("依文明而异虽然", "虽然依文明而异"),
        ("五层楼到十层楼左右", "五到十层"),
        ("三百五十CC", "三百五十毫升"),
        ("表现愤怒在街道默默走动", "愤怒地在街道默默走动"),
        ("轻重伤", "不同程度受伤"),
        ("由仅十二名", "仅由十二名"),
        (
            "他的手试图撑着古老建筑物外墙，在他的手碰到墙壁之前，单脚突然跪了下来",
            "他试图手撑古老建筑外墙，在碰到墙壁之前，突然单膝跪地",
        ),
        ("机能选择", "功能选择"),
        ("优闲", "悠闲"),
        ("内容虽然很复杂", "内容很复杂"),
    ],
    "[S1_16]某魔法的禁书目录 15X": [
        ("供家庭用建造的公寓", "供家庭居住的公寓"),
        ("棉花露出的床", "露出棉花的床"),
        ("四方二十米", "二十米见方"),
        ("因为是让葡萄发酵采取酒精", "因为是通过葡萄发酵来提取酒精"),
        ("让酒精成分高浓缩", "将酒精高度浓缩"),
        ("一口气被划瞎", "被一口气划瞎"),
        ("双膝一跪", "双膝一软"),
        ("小腿有一半埋在地板。", "小腿有一半埋在地板下。"),
        ("一次的暴发", "一次的爆发"),
        ("你的能力虽大", "你虽然能力强大"),
        ("必须品", "必需品"),
        ("转变换成", "转化为"),
    ],
    "[S1_17]某魔法的禁书目录 16X": [
        ("哪问店", "哪家店"),
        ("小心翼翼一地", "小心翼翼地"),
        ("一一十年前", "二十年前"),
        ("大小约直径", "直径约"),
        ("定食", "套餐"),
        ("支持的动作", "支持工作"),
        ("五和看来明显的微陷思考之中：", "五和显然陷入了短暂的沉思之中。"),
        ("儿童养护顺社机构", "儿童养护和福利设施"),
        ("伦教", "伦敦"),
        ("让步移动", "步行"),
        ("链接体育馆", "连接体育馆"),
        ("侵噬", "侵蚀"),
        ("往前定", "往前走"),
        ("威到", "感到"),
        ("細", "细"),
        ("边长一平方米", "边长一米"),
        ("一污渍", "污渍"),
        ("着地处所", "落脚点"),
        ("符征", "特征"),
        ("已轻", "已经"),
        ("魁悟", "魁梧"),
        ("蹒珊", "蹒跚"),
        ("听到这些片断", "听到这些片段"),
        ("混身", "浑身"),
        ("踏台", "踏脚石"),
        ("重镇人物", "重要人物"),
        ("面言", "而言"),
    ],
    "[S1_18]某魔法的禁书目录 SS2X": [
        ("品位艺术般越形高涨", "品味艺术般品味高涨"),
        ("露出肩膀的左手", "露出肩膀的左袖"),
        ("说明虽然很麻烦", "虽然说明很麻烦"),
        ("高达地面三十层楼高", "高达三十层楼"),
        ("吋", "英寸"),
        ("打了个颤", "打了个哆嗦"),
        ("近乎银色的淡金色", "比起金色更接近银色的"),
        ("配置了许多钢铁组建、特殊锏铁的胸罩", "叠加了几层钢铁的特殊胸罩"),
        ("工山的规范", "工山规范"),
        ("飞船漂浮", "飞船飘浮"),
        ("是U盘的细长棒状物", "是形似U盘的细长棒状物"),
        ("缓冲材(?!料)", "缓冲材料"),
        ("决择", "抉择"),
        ("破记录", "破纪录"),
        ("帮忙我们", "帮我们"),
    ],
    "[S1_19]某魔法的禁书目录 17X": [
        ("不能携带武器入内", "禁止携带武器"),
        ("和那么", "那么和"),
        ("短版大衣", "短款大衣"),
        ("航空<ruby>警备员<rt>Anti-Skill</rt></ruby>", "航空警备员"),
        ("航空医备员", "航空警备员"),
        ("租暴", "粗暴"),
        ("适样", "这样"),
        ("确责", "确实"),
        ("广获好评", "广受好评"),
        ("授予权限", "授予的权限"),
        ("充分足以", "足以"),
        ("拾得更高", "抬得更高"),
        ("眠神", "眼神"),
        ("长得不自然的口气", "长得不自然的气"),
    ],
    "[S1_20]某魔法的禁书目录 18X": [
        ("声青", "声音"),
        ("必杀的致命", "必杀的"),
        ("由于宇宙大爆炸现象之故，导致", "宇宙大爆炸导致"),
        ("游郊", "近郊"),
        ("塌着双肩", "耷着双肩"),
        (
            "然而，即使是如此渺小的战力，但如果是为了保护为我挺身而出，却受到伤害的人们，我可以做到。"
            "再者，如果连这样的恐惧她都能称之为「渺小」，而拥有无与伦比力量的皇姐打算伤害任何人，我可以做到。",
            "但是，如果就连那些即便力量微不足道，也为了支撑我而挺身而出的人们，都要受到伤害；"
            "再者，如果皇姐要以那份足以将此等恐怖都视作「微不足道」的压倒性力量，去折磨任何人的话——",
        ),
        ("现在就等她发动术式了", "剩下的，唯有发动术式而已"),
        ("基本上都已经全部", "基本上已经"),
        ("持续长时间", "长时间"),
        ("理所当然的，有各种人", "理所当然地，有各种人"),
        ("挖土机", "挖掘机"),
        ("画着浓妆", "化着浓妆"),
    ],
    "[S1_21]某魔法的禁书目录 19X": [
        ("想着他以为是英雄", "想着那个他以为是英雄"),
        ("十叠一百万一叠", "十叠每叠一百万"),
        ("组成而成", "组成"),
        ("永久磁石", "永磁体"),
        ("钤声", "铃声"),
        ("贩卖果汁", "售卖果汁"),
        ("原因似乎是因为", "似乎是因为"),
        ("背后出长出", "背后长出"),
        ("书喻", "形容"),
        ("起飞行机能", "起飞机能"),
    ],
    "[S1_22]某魔法的禁书目录 20X": [
        ("右方芝火", "右方之火"),
        ("惯性重力", "惯性力"),
        ("稹雪", "积雪"),
        ("因此，导致", "因此，"),
        ("再生死交关", "在生死交关"),
        ("口鼻子", "鼻子"),
    ],
    "[S1_23]某魔法的禁书目录 21X": [
        ("地铁道", "地下铁道"),
        ("接壤比邻", "接壤"),
        ("旁边苦受难的村落", "旁边受苦受难的村落"),
        ("喀睫", "咯吱"),
        ("片片断断", "片断"),
        ("出自内心深处", "源于内心深处"),
        ("安住家中", "安居家中"),
        ("避震器", "减震器"),
        ("屈指可数的窗户", "寥寥无几的窗户"),
        ("当两人一起跌倒的状态下", "在两人一起跌倒的情况下"),
        ("来白冰之翼", "来自冰之翼"),
        ("碓认", "确认"),
        ("害怕的不敢动弹", "害怕得不敢动弹"),
        ("拉距", "拉锯"),
        ("又善与恶", "由善与恶"),
        ("一片覆盖着白雪的街道", "覆盖着白雪的街道"),
        ("距离伊利沙里纳独立国同盟边境以北", "伊利沙里纳独立国同盟边境以北"),
        ("坦克和装甲车，它们", "坦克和装甲车"),
        ("对对私掠船", "对私掠船"),
        ("铠甲步兵", "铠甲的步兵"),
        ("所制成的武器", ""),
        ("即使不清楚坦克详细款式款式", "即使是不清楚坦克详细款式"),
        ("术制的桌上", "木制的桌上"),
        ("第十三早第二节", "第十三章第二节"),
        ("第二十三早第四十四节", "第二十三章第四十四节"),
        ("否则就是根本", "就是根本"),
        ("遭到这样的下场", "落得这样的下场"),
        ("两人选躲在", "两人还躲在"),
        ("灯沲光", "灯泡"),
        ("冰粒里", "冰粒"),
        ("订出精确的目标", "定出精确的目标"),
        ("的目的，纯粹是想", "纯粹是想"),
        ("用来负责", "用来"),
        ("前进基地", "朝基地前进"),
        ("束源", "来源"),
        ("知遒", "知道"),
        ("不过这是你第一次在面对敌对的专业人士", "这是你第一次在面对敌对的专业人士时"),
        ("椅了", "椅子"),
        ("杯震", "被震"),
        ("一障", "一阵"),
        ("好坏与否", "好坏"),
        ("指敦", "指教"),
        (
            "明明和滨面他们用同样的速度穿越森林的<ruby>驱动铠<rt>Powered Suit</rt></ruby>，像是",
            "<ruby>驱动铠<rt>Powered Suit</rt></ruby>明明和滨面他们用同样的速度穿越森林，却像是",
        ),
        ("不仅在被雪覆盖的疾驰", "不仅在雪地疾驰"),
        ("补强遇的", "补强的"),
        ("让人产这种", "让人产生这种"),
        ("发射并发射", "发射井发射"),
        ("罗？", "啰？"),
        ("AlM扩散力场", "AIM扩散力场"),
        ("是造成经由", "是经由"),
        ("红光其中四发", "红光中的四发"),
        ("都能让人害怕", "也能让人害怕"),
        ("你的体制", "你的体质"),
        ("势力庞大兵力", "庞大兵力"),
        ("顶言家", "预言家"),
        ("或是现在人正在上头", "还是现在人正在上头"),
        ("也不可能平安无事", "都不可能平安无事"),
        ("大概为为", "大概是为"),
        ("在不知情的状况为了", "在不知情的状况下为了"),
        ("一般军服设的", "一般军服设计的"),
        ("收到灵装某种程度保护", "受到灵装某种程度保护"),
        ("漆黑地不自然", "漆黑得不自然"),
        ("将它用到得心应手", "得心应手地使用"),
        ("延着", "沿着"),
        ("格力金能可以", "格力金能"),
    ],
    "[S1_24]某魔法的禁书目录 22X": [
        ("双脚腿", "双腿"),
        ("喃喃自语说出", "喃喃自语出"),
        ("的国家时，", ""),
        ("民问", "民间"),
        ("履次", "屡次"),
        ("状况扣", "状况？"),
        ("数十秒间就可以", "数十秒间就"),
        ("说不定像是看见", "说不定像是"),
        ("隐瞒这这件事", "隐瞒着这件事"),
        ("功输出率", "输出功率"),
        ("仅以需要的分量收集起来", "仅收集需要的分量"),
        ("用日文大喊", "用日语大喊"),
        (
            "自己手中握着控制钥匙，眼前则是控制发射用的控制面板",
            "自己手中握着钥匙，眼前则是发射控制面板",
        ),
        ("高举朝上", "高举"),
        ("偷懒懈怠", "懈怠"),
        ("百分之百几乎一定", "百分之百"),
        ("由于外在刺激导致发生错误", "由于外在刺激而发生错误"),
        ("痡", "痛"),
        ("人面很广", "人脉很广"),
        ("预想模拟", "预想"),
        ("才能可以扩展", "才能扩展"),
        ("莱布尼兹", "莱布尼茨"),
    ],
    "[S1_25]某魔法的禁书目录 SPX": [
        ("四轮传动的?越野车", "四驱越野车"),
        ("喘着太气", "喘着大气"),
        ("哭哭啼……", "哭哭啼啼……"),
        ("犹如相当于", "犹如"),
    ],
    "[S2_01]新约 某魔法的禁书目录 01X": [
        ("参了一脚", "插了一脚"),
        ("波及到我们以外的什么程度", "波及其他人到什么程度"),
    ],
    "[S2_02]新约 某魔法的禁书目录 02X": [],
    "[S2_03]新约 某魔法的禁书目录 03X": [
        ("颈链式", "项圈式"),
    ],
    "[S2_04]新约 某魔法的禁书目录 04X": [],
    "[S2_05]新约 某魔法的禁书目录 05X": [],
    "[S2_06]新约 某魔法的禁书目录 06X": [
        ("地铁路", "地下铁路"),
    ],
    "[S2_07]新约 某魔法的禁书目录 07X": [],
    "[S2_08]新约 某魔法的禁书目录 08X": [],
    "[S2_09]新约 某魔法的禁书目录 09X": [],
    "[S2_10]新约 某魔法的禁书目录 10X": [
        ("食用期限经过了", "保质期已经过了"),
    ],
    "[S2_11]新约 某魔法的禁书目录 11X": [
        ("定食店", "套餐店"),
        ("收看这这些", "收看这些"),
    ],
    "[S2_12]新约 某魔法的禁书目录 12X": [],
    "[S2_13]新约 某魔法的禁书目录 13X": [
        ("尽可能试着", "尽可能"),
    ],
    "[S2_14]新约 某魔法的禁书目录 14X": [],
    "[S2_15]新约 某魔法的禁书目录 15X": [
        ("就在附j", "就在附——」"),
    ],
    "[S2_16]新约 某魔法的禁书目录 16X": [
        ("光碟", "光盘"),
    ],
    "[S2_17]新约 某魔法的禁书目录 17X": [],
    "[S2_18]新约 某魔法的禁书目录 18X": [],
    "[S2_19]新约 某魔法的禁书目录 19X": [],
    "[S2_20]新约 某魔法的禁书目录 20X": [
        ("地铁路", "地下铁路"),
    ],
    "[S2_21]新约 某魔法的禁书目录 21X": [],
    "[S2_22]新约 某魔法的禁书目录 22X": [],
    "[S2_23]新约 某魔法的禁书目录 22REVERSEX": [
        ("阴——<", "阴——」<"),
    ],
    "[S3_01]创约 某魔法的禁书目录 01X": [],
    "[S3_02]创约 某魔法的禁书目录 02X": [],
    "[S3_03]创约 某魔法的禁书目录 03X": [],
    "[S3_04]创约 某魔法的禁书目录 04X": [
        ("飞机器", "飞行机器"),
    ],
    "[S3_05]创约 某魔法的禁书目录 05X": [
        ("亚铅", "锌"),
    ],
    "[S3_06]创约 某魔法的禁书目录 06X": [
        ("干点别的话", "干点别的的话"),
    ],
    "[S3_07]创约 某魔法的禁书目录 07X": [],
    "[S3_08]创约 某魔法的禁书目录 08X": [
        ("这这太复杂", "这太复杂"),
    ],
    "[S3_09]创约 某魔法的禁书目录 09X": [],
    "[S3_10]创约 某魔法的禁书目录 10X": [],
    "[S4_01]某暗部的少女共栖 1X": [
        ("十分感x", "十分感——」"),
    ],
    "[S4_02]某暗部的少女共栖 2X": [],
    "[S4_03]某暗部的少女共栖 3X": [
        ("荧幕", "银幕"),
        ("知——</p>", "知——」</p>"),
        ("桌——</p>", "桌——」</p>"),
    ],
    "[S5_01_01]某魔法的禁书目录SS 神裂火织篇X": [],
    "[S5_01_02]某魔法的禁书目录SS 必要之恶教会的考验X": [
        ("十几岁左右（青少年）</p>", "十几岁左右（青少年）。</p>"),
        ("延着", "沿着"),
    ],
    "[S5_01_03]某魔法的禁书目录 通向恩底弥翁之路X": [
        ("这这么做", "这么做"),
    ],
    "[S5_02_01]某科学的超电磁炮SS 学艺都市篇X": [
        ("84 , 45 , 81 。", "84、45、81。"),
    ],
    "[S5_02_02]某科学的超电磁炮SS2 能力实演旅行篇X": [
        ("飞机器", "飞行机器"),
        ("述说这这样", "述说着这样"),
    ],
    "[S5_02_03]某科学的超电磁炮 ColdGameX": [],
    "[S5_03_02]某魔法的禁书目录SS 生物黑客篇X": [
        ("由于这道菜里", "因为这道菜里"),
    ],
    "[S5_04_01]某科学的超电磁炮SS3 斯塔蒂瓦里篇X": [
        ("程式", "程序"),
        ("谁都能看得出现的异常", "谁都能看得出的异常"),
        ("槽了", "糟了"),
    ],
    "[S6_10.06.26]某自动贩卖机的存在证明X": [],
    "[S6_14.09.10]新约 某魔法的禁书目录SSX": [],
    "[S6_18.04.10]新约 某魔法的禁书目录 玻璃另一侧的BIRTHDAYX": [],
    "[S6_20.05.09]创约 某魔法的禁书目录SS 黑夜海鸟篇X": [],
    "[S6_24.01.10]某科学的心理掌握 女王的戏剧X": [
        ("磨练", "磨炼"),
    ],
    "[S6_24.12.10]创约 某魔法的禁书目录SS 黄金黎明篇X": [
        ("抛弃m", "抛弃——」"),
    ],
}


def fixed(vol: str, content: str) -> str:
    for old, new in fixes[vol] + fixes["*"]:
        content = re.sub(old, new, content)
    return content


def x2y():
    x, y = Path("X"), Path("Y")
    shutil.rmtree(y)
    for vol in tqdm(list(x.iterdir())):
        shutil.copytree(vol, y / vol.name)
        for file in (y / vol.name).rglob("*"):
            if file.suffix not in (".xhtml", ".opf", ".ncx"):
                continue
            with open(file, "r", encoding="utf-8") as f:
                content = f.read()
            with open(file, "w", encoding="utf-8") as f:
                f.write(fixed(vol.name, content))


if __name__ == "__main__":
    x2y()
